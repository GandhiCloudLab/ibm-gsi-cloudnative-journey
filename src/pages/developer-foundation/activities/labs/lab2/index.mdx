---
title: Kubernetes Lab 2 - Pod Configuration
---


 <div style="border-bottom: 3px solid grey;">
        <div class="bx--row" style="padding-left:20px">
            <p class="bx--col" style="font-weight: bold;font-size: 20px;">HANDS ON LAB:</p><p class="bx--col" style="font-size: 20px;padding-left:5px;">Pod Configuration</p>
        </div>
    </div>
    <div class="bx--row">
        <div class="bx--col-sm-2 bx--col-md-2 bx--col-lg-2">
        
         <div id="slideshowNavigator" style="font-size:15px; text-align: center; border-right: 1px solid gray;">
            <div style="padding: 10px 0 10px 0px; width:70px">
                <img src="images/goal.png"/>
                Goal
            </div>
            <div style="padding: 10px 0 10px 0px;  width:80px; ">
                <img src="images/learn.png"/>
               <p> What you'll learn</p>
            </div>
            <div style="padding: 10px 0 10px 0px;  width:55px">
                <img src="images/faq.png"/>
                Exercises
            </div>
            <div style="padding: 10px 0 10px 0px;  width:55px">
                <img src="images/explore.png"/>
                Explore
            </div>
        </div>
        </div>
        <div class="bx--col-sm-7 bx--col-md-7 bx--col-lg-7">
            <div class="bx--row" style="padding: 22px 10px;">
            Create a pod definition named  <span style="padding-left: 5px;background-color: #c6c6c6;"> yoda-service-pod.yml </span>, and then create a pod in the cluster using this definition to make sure it works.
            </div>
            <div class="bx--row" style="padding: 20px 0px 0px 0px;">
            For this exercises creating the Service, ConfigMap, Secret and learn the each resource definition. 
            </div>
            <div class="bx--row" style="padding: 50px 0px 0px 0px;">
            Paly around  resources like <span> Service, ConfigMap, Secret </span> and execute the command to create the resource in Openshift Console.
            </div>
            <div class="bx--row" style="padding: 32px 0px 0px 0px;">
               Explore the resources configuration and definition
            </div>
        </div>
         <div class="bx--col-sm-2 bx--col-md-2 bx--col-lg-2">
            <div class="bx--row" style="padding-top: 15px;">
            Difficulty Level
            </div>
             <div class="bx--row" style="padding-top: 6px;">
            Duration
            </div>
        </div>
         <div class="bx--col-sm-1 bx--col-md-1 bx--col-lg-1">
            <div class="bx--row" style="font-weight:bold; padding-top: 15px;">
            Beginner
            </div>
            <div class="bx--row" style="font-weight:bold; padding-top: 7px;">
            5 Min
            </div>
        </div>
    </div>


## Specification

 - The current image for the container is `bitnami/nginx`. You do not need a custom command or args.
 - There is some configuration data the container will need:
    - `yoda.baby.power=100000000`
    - `yoda.strength=10`
 - It will expect to find this data in a file at `/etc/yoda-service/yoda.cfg`. Store the configuration data in a ConfigMap called `yoda-service-config` and provide it to the container as a mounted volume.
 - The container should expect to use `64Mi` of memory and `250m` CPU (use resource requests).
 - The container should be limited to `128Mi` of memory and `500m` CPU (use resource limits).
 - The container needs access to a database password in order to authenticate with a backend database server. The password is `0penSh1ftRul3s!`. It should be stored as a Kubernetes secret called `yoda-db-password` and passed to the container as an *environment variable* called `DB_PASSWORD`.
 - The container will need to access the Kubernetes API using the ServiceAccount `yoda-svc`. Create the service account if it doesn't already exist, and configure the pod to use it.


## Solutions

- Create the Service Account executing the following command.

 ```shell script
  oc create sa yoda-svc -n {DEV_NAMESPACE}
  ```

- Once the Service Account created, create the ConfigMap,Secret.

- Create the Yaml file for POD, ConfigMap, Secret using below POD configuration.

- Execute the below command for creating ConfigMap,Secret.

  ```shell script
  oc apply -f Downloads/yoda-service-config.yaml -n {DEV_NAMESPACE}
  oc apply -f Downloads/yoda-db-password.yaml -n {DEV_NAMESPACE}
  ```  
- Execute the below command for creating the POD.

 ```shell script
  oc apply -f Downloads/yoda-service-pod.yml -n {DEV_NAMESPACE}
  ``` 

<Accordion>
<AccordionItem title="Pod Configuration">

    
    apiVersion: v1
    kind: ConfigMap
    metadata:
      name: yoda-service-config
    data:
      yoda.cfg: |-
        yoda.baby.power=100000000
        yoda.strength=10
   
------------------------
    
    apiVersion: v1
    kind: Secret
    metadata:
      name: yoda-db-password
    stringData:
      password: 0penSh1ftRul3s!
    
------------------------
    
    apiVersion: v1
    kind: Pod
    metadata:
      name: yoda-service
    spec:
      serviceAccountName: yoda-svc
      containers:
      - name: yoda-service
        image: bitnami/nginx
        volumeMounts:
        - name: config-volume
          mountPath: /etc/yoda-service
        env:
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: yoda-db-password
              key: password
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
      volumes:
      - name: config-volume
          configMap:
            name: yoda-service-config
    
</AccordionItem>
</Accordion>

## Verification

To verify your setup is complete, check `/etc/yoda-service` for the `yoda.cfg` file and use the `cat` command to check it's contents.

```
kubectl exec -it yoda-service /bin/bash
cd /etc/yoda-service
cat yoda.cfg
```